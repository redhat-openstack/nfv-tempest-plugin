{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "af8ff768_cf23e333",
        "filename": "nfv_tempest_plugin/tests/scenario/baremetal_manager.py",
        "patchSetId": 1
      },
      "lineNbr": 517,
      "author": {
        "id": 1008672
      },
      "writtenOn": "2021-02-15T18:37:50Z",
      "side": 1,
      "message": "Ella,\nWhat is the reason for that change?\n\nThe \"self.remote_ssh_sec_groups\" and \"self.remote_ssh_sec_groups_names\" created here - https://github.com/redhat-openstack/nfv-tempest-plugin/blob/master/nfv_tempest_plugin/tests/scenario/baremetal_manager.py#L862-L865.\n\nThe reason for those two class variables, is the way, how some of the processes are working.\nWhen some rule needs to be added to a security group, a security group id is required and here the \"self.remote_ssh_sec_groups\" var holds both name and id of the sec group.\nWhen an instance spawned, the nova api accepts only sec group name and fails if id of sec group provided.\n\nThe reason, that the id of the sec group is not removed before instance creation, is the following use case:\n\nA test creates for resources with specific security group.\nPerforming some tasks.\nAnd then need to spawn additional instances.\nIn order to be able to use the same security group and connection between the instances, the security group name needs to be available in any time during the test.",
      "revId": "f77c4977dc854f019ce6a0acec413aef45f7fbdb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "66ed237b_b3b8b12d",
        "filename": "nfv_tempest_plugin/tests/scenario/baremetal_manager.py",
        "patchSetId": 1
      },
      "lineNbr": 517,
      "author": {
        "id": 1018675
      },
      "writtenOn": "2021-02-16T08:15:58Z",
      "side": 1,
      "message": "Hi maxim\nthe reason for the change is to allow adding more then just the ssh sec group on instance creation. I think it will be very useful for tests requires more then just ssh in there sec group and also makes the sec group creation more specific.\n\nalso you are currect and I also encountered this error when not removeing the ID but please look at line 829 where I remove the ID exactly for the reason you mentioned\n\nalso because it creates all ports at once and only then removes the id from kwargs[\u0027security_grpous\u0027] all servers gets all security groups needed and all servers created with those sec_groups\n\n\nI can do it with a class var (self.sg) but I don\u0027t see any reason it cant be a local var in my opinion the class vars should be changed but I left it this way for now to not mix the changes and not break anything",
      "parentUuid": "af8ff768_cf23e333",
      "revId": "f77c4977dc854f019ce6a0acec413aef45f7fbdb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "05ad33c6_91bffe15",
        "filename": "nfv_tempest_plugin/tests/scenario/baremetal_manager.py",
        "patchSetId": 1
      },
      "lineNbr": 517,
      "author": {
        "id": 1008672
      },
      "writtenOn": "2021-02-16T08:34:31Z",
      "side": 1,
      "message": "I still don\u0027t think that this specific part of the code should be changed.\nThis part of the code adds the security group to the port.\n\nIf you would like to modify the rule of the security group, you have a dedicated methods to do it.\n\nRegarding the use cases.\nIn the numa aware vswitch test [1], a scenario which requires such implementation, exists.\nThe test boots instances not in one spawn.\nSo when the instance in the second stage booted, it needs to know the security group to be used and in such way I\u0027m able to split the creation of the instance to multiple parts with no issues.\n\n\n[1] - https://github.com/redhat-openstack/nfv-tempest-plugin/blob/master/nfv_tempest_plugin/tests/scenario/test_nfv_advanced_usecases.py#L36",
      "parentUuid": "66ed237b_b3b8b12d",
      "revId": "f77c4977dc854f019ce6a0acec413aef45f7fbdb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "710bf6f5_e1b00fba",
        "filename": "nfv_tempest_plugin/tests/scenario/baremetal_manager.py",
        "patchSetId": 1
      },
      "lineNbr": 517,
      "author": {
        "id": 1018675
      },
      "writtenOn": "2021-02-16T08:45:16Z",
      "side": 1,
      "message": "I still thinks that its a good idea to have the ability to add sec group on instance creation and not just changing the ssh sg created \n\nI\u0027m not sure I understand the reason why you shouldn\u0027t be able to add sg on instance creation? the only thing that this change brings is the ability to do so in case you don\u0027t need any additional sec group you just dont use security_groups in the kwargs you are sending to the function",
      "parentUuid": "05ad33c6_91bffe15",
      "revId": "f77c4977dc854f019ce6a0acec413aef45f7fbdb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e5cb7935_262e09f4",
        "filename": "nfv_tempest_plugin/tests/scenario/baremetal_manager.py",
        "patchSetId": 1
      },
      "lineNbr": 517,
      "author": {
        "id": 1008672
      },
      "writtenOn": "2021-02-16T10:06:26Z",
      "side": 1,
      "message": "I\u0027m not saying that you should not add any new functionality to existing methods.\nI\u0027m not saying you should not change the structure of existing methods.\n\nI\u0027m saying the current structure is used and required by at least one test (numa aware vswitch).\nI\u0027m saying that this change will break at least one test.",
      "parentUuid": "710bf6f5_e1b00fba",
      "revId": "f77c4977dc854f019ce6a0acec413aef45f7fbdb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7fe31bbf_2f100f1b",
        "filename": "nfv_tempest_plugin/tests/scenario/baremetal_manager.py",
        "patchSetId": 1
      },
      "lineNbr": 517,
      "author": {
        "id": 1018675
      },
      "writtenOn": "2021-02-16T11:38:38Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "e5cb7935_262e09f4",
      "revId": "f77c4977dc854f019ce6a0acec413aef45f7fbdb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "102244da_df762383",
        "filename": "nfv_tempest_plugin/tests/scenario/baremetal_manager.py",
        "patchSetId": 1
      },
      "lineNbr": 820,
      "author": {
        "id": 1008672
      },
      "writtenOn": "2021-02-15T18:37:50Z",
      "side": 1,
      "message": "Same as above.",
      "range": {
        "startLine": 820,
        "startChar": 11,
        "endLine": 820,
        "endChar": 30
      },
      "revId": "f77c4977dc854f019ce6a0acec413aef45f7fbdb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "63ca44f8_358ab401",
        "filename": "nfv_tempest_plugin/tests/scenario/qos_manager.py",
        "patchSetId": 1
      },
      "lineNbr": 208,
      "author": {
        "id": 1008672
      },
      "writtenOn": "2021-02-15T18:37:50Z",
      "side": 1,
      "message": "We already have a method to create security group [1] and a method to set the rules for that group [2].\n\nI suggest to use those methods instead of create a duplicate code.\nIn the methods do not have required functions, please extend them.\n\n[1] - https://github.com/redhat-openstack/nfv-tempest-plugin/blob/master/nfv_tempest_plugin/tests/scenario/baremetal_manager.py#L867\n[2] - https://github.com/redhat-openstack/nfv-tempest-plugin/blob/master/nfv_tempest_plugin/tests/scenario/baremetal_manager.py#L902",
      "range": {
        "startLine": 208,
        "startChar": 8,
        "endLine": 208,
        "endChar": 35
      },
      "revId": "f77c4977dc854f019ce6a0acec413aef45f7fbdb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "14b3ef22_33531289",
        "filename": "nfv_tempest_plugin/tests/scenario/qos_manager.py",
        "patchSetId": 1
      },
      "lineNbr": 208,
      "author": {
        "id": 1018675
      },
      "writtenOn": "2021-02-16T08:15:58Z",
      "side": 1,
      "message": "totally correct I missed those thanks ðŸ˜Š",
      "parentUuid": "63ca44f8_358ab401",
      "range": {
        "startLine": 208,
        "startChar": 8,
        "endLine": 208,
        "endChar": 35
      },
      "revId": "f77c4977dc854f019ce6a0acec413aef45f7fbdb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ]
}